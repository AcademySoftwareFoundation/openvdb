<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>OpenVDB: StreamCompression.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVDB
   &#160;<span id="projectnumber">8.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_280f52b45faa7feb3f4c229d1d8418c8.html">openvdb</a></li><li class="navelem"><a class="el" href="dir_5862e09d5e9b1231151ba919eed3a485.html">openvdb</a></li><li class="navelem"><a class="el" href="dir_c9229911bfd1cba3327f6b216c5f36b0.html">points</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">StreamCompression.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Convenience wrappers to using Blosc and reading and writing of Paged data.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="io_8h_source.html">openvdb/io/io.h</a>&gt;</code><br />
<code>#include &lt;tbb/spin_mutex.h&gt;</code><br />
<code>#include &lt;memory&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
</div>
<p><a href="StreamCompression_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopenvdb_1_1v8__1_1_1compression_1_1Page.html">Page</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores a variable-size, compressed, delayed-load <a class="el" href="classopenvdb_1_1v8__1_1_1compression_1_1Page.html" title="Stores a variable-size, compressed, delayed-load Page of data that is loaded into memory when accesse...">Page</a> of data that is loaded into memory when accessed. Access to the <a class="el" href="classopenvdb_1_1v8__1_1_1compression_1_1Page.html" title="Stores a variable-size, compressed, delayed-load Page of data that is loaded into memory when accesse...">Page</a> is thread-safe as loading and decompressing the data is protected by a mutex.  <a href="classopenvdb_1_1v8__1_1_1compression_1_1Page.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopenvdb_1_1v8__1_1_1compression_1_1PageHandle.html">PageHandle</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <a class="el" href="classopenvdb_1_1v8__1_1_1compression_1_1PageHandle.html" title="A PageHandle holds a unique ptr to a Page and a specific stream pointer to a point within the decompr...">PageHandle</a> holds a unique ptr to a <a class="el" href="classopenvdb_1_1v8__1_1_1compression_1_1Page.html" title="Stores a variable-size, compressed, delayed-load Page of data that is loaded into memory when accesse...">Page</a> and a specific stream pointer to a point within the decompressed <a class="el" href="classopenvdb_1_1v8__1_1_1compression_1_1Page.html" title="Stores a variable-size, compressed, delayed-load Page of data that is loaded into memory when accesse...">Page</a> buffer.  <a href="classopenvdb_1_1v8__1_1_1compression_1_1PageHandle.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopenvdb_1_1v8__1_1_1compression_1_1PagedInputStream.html">PagedInputStream</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A Paging wrapper to std::istream that is responsible for reading from a given input stream and creating <a class="el" href="classopenvdb_1_1v8__1_1_1compression_1_1Page.html" title="Stores a variable-size, compressed, delayed-load Page of data that is loaded into memory when accesse...">Page</a> objects and PageHandles that reference those pages for delayed reading.  <a href="classopenvdb_1_1v8__1_1_1compression_1_1PagedInputStream.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopenvdb_1_1v8__1_1_1compression_1_1PagedOutputStream.html">PagedOutputStream</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A Paging wrapper to std::ostream that is responsible for writing from a given output stream at intervals set by the PageSize. As Pages are variable in size, they are flushed to disk as soon as sufficiently large.  <a href="classopenvdb_1_1v8__1_1_1compression_1_1PagedOutputStream.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceopenvdb"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb.html">openvdb</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceopenvdb_1_1v8__1"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1.html">openvdb::v8_1</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceopenvdb_1_1v8__1_1_1compression"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1_1_1compression.html">openvdb::v8_1::compression</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a70b73c78f2598c87c3a71ab1d3ba709f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Platform_8h.html#a78ead02913edfee18be9d5982b788611">OPENVDB_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1_1_1compression.html#a70b73c78f2598c87c3a71ab1d3ba709f">bloscCanCompress</a> ()</td></tr>
<tr class="memdesc:a70b73c78f2598c87c3a71ab1d3ba709f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if compression is available.  <a href="namespaceopenvdb_1_1v8__1_1_1compression.html#a70b73c78f2598c87c3a71ab1d3ba709f">More...</a><br /></td></tr>
<tr class="separator:a70b73c78f2598c87c3a71ab1d3ba709f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25fc2d80256c038004a6c08197e83620"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Platform_8h.html#a78ead02913edfee18be9d5982b788611">OPENVDB_API</a> size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1_1_1compression.html#a25fc2d80256c038004a6c08197e83620">bloscUncompressedSize</a> (const char *buffer)</td></tr>
<tr class="memdesc:a25fc2d80256c038004a6c08197e83620"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the uncompressed size of buffer when uncompressed.  <a href="namespaceopenvdb_1_1v8__1_1_1compression.html#a25fc2d80256c038004a6c08197e83620">More...</a><br /></td></tr>
<tr class="separator:a25fc2d80256c038004a6c08197e83620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad01376fadba572db69c9f62dc7117c5a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Platform_8h.html#a78ead02913edfee18be9d5982b788611">OPENVDB_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1_1_1compression.html#ad01376fadba572db69c9f62dc7117c5a">bloscCompress</a> (char *compressedBuffer, size_t &amp;compressedBytes, const size_t bufferBytes, const char *uncompressedBuffer, const size_t uncompressedBytes)</td></tr>
<tr class="memdesc:ad01376fadba572db69c9f62dc7117c5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compress into the supplied buffer.  <a href="namespaceopenvdb_1_1v8__1_1_1compression.html#ad01376fadba572db69c9f62dc7117c5a">More...</a><br /></td></tr>
<tr class="separator:ad01376fadba572db69c9f62dc7117c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5032839db00dc87861a439d62e41a783"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Platform_8h.html#a78ead02913edfee18be9d5982b788611">OPENVDB_API</a> std::unique_ptr&lt; char[]&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1_1_1compression.html#a5032839db00dc87861a439d62e41a783">bloscCompress</a> (const char *buffer, const size_t uncompressedBytes, size_t &amp;compressedBytes, const bool resize=true)</td></tr>
<tr class="memdesc:a5032839db00dc87861a439d62e41a783"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compress and return the heap-allocated compressed buffer.  <a href="namespaceopenvdb_1_1v8__1_1_1compression.html#a5032839db00dc87861a439d62e41a783">More...</a><br /></td></tr>
<tr class="separator:a5032839db00dc87861a439d62e41a783"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73dd799ff8d3a9816e0a430392c45e48"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Platform_8h.html#a78ead02913edfee18be9d5982b788611">OPENVDB_API</a> size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1_1_1compression.html#a73dd799ff8d3a9816e0a430392c45e48">bloscCompressedSize</a> (const char *buffer, const size_t uncompressedBytes)</td></tr>
<tr class="memdesc:a73dd799ff8d3a9816e0a430392c45e48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convenience wrapper to retrieve the compressed size of buffer when compressed.  <a href="namespaceopenvdb_1_1v8__1_1_1compression.html#a73dd799ff8d3a9816e0a430392c45e48">More...</a><br /></td></tr>
<tr class="separator:a73dd799ff8d3a9816e0a430392c45e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac95793b29c55907e0e6b6e4cf5b8281c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Platform_8h.html#a78ead02913edfee18be9d5982b788611">OPENVDB_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1_1_1compression.html#ac95793b29c55907e0e6b6e4cf5b8281c">bloscDecompress</a> (char *uncompressedBuffer, const size_t expectedBytes, const size_t bufferBytes, const char *compressedBuffer)</td></tr>
<tr class="memdesc:ac95793b29c55907e0e6b6e4cf5b8281c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decompress into the supplied buffer. Will throw if decompression fails or uncompressed buffer has insufficient space in which to decompress.  <a href="namespaceopenvdb_1_1v8__1_1_1compression.html#ac95793b29c55907e0e6b6e4cf5b8281c">More...</a><br /></td></tr>
<tr class="separator:ac95793b29c55907e0e6b6e4cf5b8281c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c20baf2826b9ef08def5d267b4f1e56"><td class="memItemLeft" align="right" valign="top"><a class="el" href="Platform_8h.html#a78ead02913edfee18be9d5982b788611">OPENVDB_API</a> std::unique_ptr&lt; char[]&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1_1_1compression.html#a4c20baf2826b9ef08def5d267b4f1e56">bloscDecompress</a> (const char *buffer, const size_t expectedBytes, const bool resize=true)</td></tr>
<tr class="memdesc:a4c20baf2826b9ef08def5d267b4f1e56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decompress and return the the heap-allocated uncompressed buffer.  <a href="namespaceopenvdb_1_1v8__1_1_1compression.html#a4c20baf2826b9ef08def5d267b4f1e56">More...</a><br /></td></tr>
<tr class="separator:a4c20baf2826b9ef08def5d267b4f1e56"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a357d39b19797f6375a13d16e87596956"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1_1_1compression.html#a357d39b19797f6375a13d16e87596956">BLOSC_MINIMUM_BYTES</a> = 48</td></tr>
<tr class="separator:a357d39b19797f6375a13d16e87596956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2650a4d6240086a893f6ad4b7fa7b866"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1_1_1compression.html#a2650a4d6240086a893f6ad4b7fa7b866">BLOSC_PAD_BYTES</a> = 128</td></tr>
<tr class="separator:a2650a4d6240086a893f6ad4b7fa7b866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00f9a3d50d99cb17ea2b7d1752c81cfe"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopenvdb_1_1v8__1_1_1compression.html#a00f9a3d50d99cb17ea2b7d1752c81cfe">PageSize</a> = 1024 * 1024</td></tr>
<tr class="separator:a00f9a3d50d99cb17ea2b7d1752c81cfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Convenience wrappers to using Blosc and reading and writing of Paged data. </p>
<dl class="section author"><dt>Author</dt><dd>Dan Bailey</dd></dl>
<p>Blosc is most effective with large (&gt; ~256KB) blocks of data. Writing the entire data block contiguously would provide the most optimal compression, however would limit the ability to use delayed-loading as the whole block would be required to be loaded from disk at once. To balance these two competing factors, Paging is used to write out blocks of data that are a reasonable size for Blosc. These Pages are loaded lazily, tracking the input stream pointers and creating Handles that reference portions of the buffer. When the Page buffer is accessed, the data will be read from the stream. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
